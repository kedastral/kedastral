workloads:
  - name: web-api
    metric: http_requests_per_second
    adapter: prometheus
    adapterConfig:
      url: http://prometheus:9090
      query: sum(rate(http_requests_total{app="web-api"}[1m]))
    horizon: 30m
    step: 1m
    interval: 30s
    window: 1h
    model: baseline
    targetPerPod: 100.0
    headroom: 1.2
    minReplicas: 2
    maxReplicas: 50
    upMaxFactorPerStep: 2.0
    downMaxPercentPerStep: 50

  - name: background-worker
    metric: queue_depth
    adapter: prometheus
    adapterConfig:
      url: http://prometheus:9090
      query: sum(rabbitmq_queue_messages{queue="tasks"})
    horizon: 1h
    step: 5m
    interval: 1m
    window: 2h
    model: baseline
    targetPerPod: 50.0
    headroom: 1.5
    minReplicas: 1
    maxReplicas: 20
    upMaxFactorPerStep: 3.0
    downMaxPercentPerStep: 30

  - name: data-processor
    metric: processing_lag_seconds
    adapter: prometheus
    adapterConfig:
      url: http://prometheus:9090
      query: max(kafka_consumer_lag_seconds{topic="events"})
    horizon: 15m
    step: 30s
    interval: 15s
    window: 30m
    model: arima
    arimaP: 2
    arimaD: 1
    arimaQ: 1
    targetPerPod: 60.0
    headroom: 1.3
    minReplicas: 3
    maxReplicas: 100
    upMaxFactorPerStep: 2.5
    downMaxPercentPerStep: 40
